<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced analysis of longitudinal data – 4&nbsp; Trajectories of accommodation in Germany</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./trajectories.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./accommodation.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Trajectories of accommodation in Germany</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced analysis of longitudinal data</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Predictive modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./trajectories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory mining</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accommodation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Trajectories of accommodation in Germany</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#frequency-tables" id="toc-frequency-tables" class="nav-link active" data-scroll-target="#frequency-tables"><span class="header-section-number">4.1</span> Frequency tables</a></li>
  <li><a href="#most-frequent-sequences-plot" id="toc-most-frequent-sequences-plot" class="nav-link" data-scroll-target="#most-frequent-sequences-plot"><span class="header-section-number">4.2</span> Most frequent sequences plot</a></li>
  <li><a href="#transition-types" id="toc-transition-types" class="nav-link" data-scroll-target="#transition-types"><span class="header-section-number">4.3</span> Transition Types</a></li>
  <li><a href="#stable-sequences" id="toc-stable-sequences" class="nav-link" data-scroll-target="#stable-sequences"><span class="header-section-number">4.4</span> Stable sequences</a></li>
  <li><a href="#sequences-with-transitions" id="toc-sequences-with-transitions" class="nav-link" data-scroll-target="#sequences-with-transitions"><span class="header-section-number">4.5</span> Sequences with transitions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Trajectories of accommodation in Germany</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The data were prepared for analysis as follows: the longitudinal data format was converted into a wide format for two variables: country and accommodation for rounds 4, 10, 16, 21/22. The converted data are stored in the file “wide-accomm.rds” for further analysis of trajectories.</p>
<p>На першому кроці аналізу завантажуються потрібні пакети, які дозволяють заповнити пропущені значення і визначити послідовності станів для змінної accommodation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TraMineR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
TraMineR stable version 2.2-9 (Built: 2024-04-27)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Website: http://traminer.unige.ch</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Please type 'citation("TraMineR")' for citation information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TraMineRextras)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>TraMineRextras stable version 0.6.7 (Built: 2024-04-27)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Functions provided by this package are still in test</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    and subject to changes in future releases.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seqimpute)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"wide-accomm.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill only internal gaps in the data using Multiple Imputation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="fu">seqimpute</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  wide, <span class="at">var =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">timing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">npt =</span> <span class="dv">0</span>, <span class="at">nfi =</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>iteration : 1 / 1 
[1] "Imputation of the internal gaps..."
[1] "Step 1/2"
[1] "Step 2/2"</code></pre>
</div>
</div>
<p>Define sequence object. Five states</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sequence.alphabet <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'authorities'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'rented'</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'other'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'in Ukraine'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'in other country'</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sequence.scode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AUTHOR"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"RENTED"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"OTHACC"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"IN.UKR"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"IN.OTH"</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>sequence.lab <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Provided by authorities'</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Rented'</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Other types of accommodation'</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'in Ukraine'</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">'in other country'</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>sequence.seq <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sequence<span class="sc">$</span>imp<span class="sc">$</span>imp1,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">alphabet =</span> sequence.alphabet,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">states =</span> sequence.scode,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> sequence.lab,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">xtstep =</span> <span class="dv">1</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">cpal =</span> <span class="fu">rainbow</span>(<span class="dv">5</span>),</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">left =</span> <span class="cn">NA</span>, <span class="at">right =</span> <span class="cn">NA</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] found missing values ('NA') in sequence data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] preparing 1193 sequences</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] coding void elements with '%' and missing values with '*'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] state coding:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>       [alphabet]       [label]  [long label] </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>     1  authorities      AUTHOR   Provided by authorities</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>     2  rented           RENTED   Rented</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>     3  other            OTHACC   Other types of accommodation</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>     4  in Ukraine       IN.UKR   in Ukraine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>     5  in other country IN.OTH   in other country</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] 1193 sequences in the data set</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] min/max sequence length: 4/4</code></pre>
</div>
</div>
<section id="frequency-tables" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="frequency-tables"><span class="header-section-number">4.1</span> Frequency tables</h2>
<p>All existing sequences of accommodation trajectories, sorted from the most frequent to the least frequent.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtab</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  sequence.seq, <span class="at">idxs =</span> <span class="dv">0</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    Freq Percent
*/1-AUTHOR/3                         132  11.065
*/3-AUTHOR/1                         120  10.059
*/1-AUTHOR/1                          54   4.526
*/2-AUTHOR/2                          51   4.275
OTHACC/1                              45   3.772
*/1-RENTED/1-AUTHOR/2                 43   3.604
*/1-AUTHOR/2                          42   3.521
*/2-AUTHOR/1                          37   3.101
AUTHOR/1                              31   2.598
*/1-RENTED/3                          28   2.347
*/1-OTHACC/1                          27   2.263
*/1-RENTED/1                          27   2.263
*/1-OTHACC/3                          26   2.179
*/3-RENTED/1                          26   2.179
*/3-OTHACC/1                          25   2.096
*/2-OTHACC/2                          18   1.509
*/1-OTHACC/1-IN.UKR/2                 16   1.341
OTHACC/1-AUTHOR/3                     16   1.341
AUTHOR/4                              14   1.174
RENTED/1                              14   1.174
*/1-AUTHOR/1-IN.UKR/2                 13   1.090
*/1-OTHACC/1-AUTHOR/2                 13   1.090
*/2-OTHACC/1                          12   1.006
*/1-OTHACC/2                          11   0.922
*/1-RENTED/1-AUTHOR/1                 10   0.838
*/1-OTHACC/1-AUTHOR/1                  9   0.754
OTHACC/1-AUTHOR/2                      9   0.754
OTHACC/4                               9   0.754
*/1-OTHACC/2-AUTHOR/1                  8   0.671
*/2-RENTED/2                           8   0.671
OTHACC/1-IN.UKR/3                      8   0.671
AUTHOR/3                               7   0.587
OTHACC/2-AUTHOR/2                      7   0.587
RENTED/2-AUTHOR/2                      7   0.587
*/1-AUTHOR/1-IN.UKR/1                  6   0.503
*/1-RENTED/1-IN.UKR/2                  6   0.503
OTHACC/2                               6   0.503
RENTED/2                               6   0.503
*/1-OTHACC/1-RENTED/2                  5   0.419
*/1-RENTED/1-AUTHOR/1-RENTED/1         5   0.419
IN.OTH/1-OTHACC/1-AUTHOR/2             5   0.419
OTHACC/1-RENTED/1-AUTHOR/1             5   0.419
OTHACC/1-RENTED/1-AUTHOR/2             5   0.419
RENTED/1-AUTHOR/3                      5   0.419
*/1-AUTHOR/2-RENTED/1                  4   0.335
*/1-IN.OTH/1-AUTHOR/2                  4   0.335
*/1-RENTED/2                           4   0.335
*/1-RENTED/2-AUTHOR/1                  4   0.335
*/2-RENTED/1                           4   0.335
*/2-RENTED/1-AUTHOR/1                  4   0.335
AUTHOR/2                               4   0.335
IN.OTH/1-AUTHOR/3                      4   0.335
IN.OTH/2-OTHACC/2                      4   0.335
IN.OTH/3-AUTHOR/1                      4   0.335
OTHACC/1-IN.UKR/2                      4   0.335
OTHACC/2-IN.UKR/2                      4   0.335
OTHACC/3                               4   0.335
RENTED/1-IN.UKR/3                      4   0.335
RENTED/3                               4   0.335
*/1-IN.OTH/1-OTHACC/2                  3   0.251
*/1-IN.OTH/2-AUTHOR/1                  3   0.251
*/1-IN.OTH/2-OTHACC/1                  3   0.251
AUTHOR/1-OTHACC/1-AUTHOR/2             3   0.251
AUTHOR/2-IN.UKR/2                      3   0.251
IN.OTH/1-OTHACC/3                      3   0.251
OTHACC/1-AUTHOR/1                      3   0.251
OTHACC/1-IN.OTH/3                      3   0.251
OTHACC/2-AUTHOR/1                      3   0.251
RENTED/1-IN.UKR/1                      3   0.251
RENTED/4                               3   0.251
*/1-AUTHOR/1-OTHACC/2                  2   0.168
*/1-AUTHOR/1-RENTED/2                  2   0.168
*/1-AUTHOR/2-IN.UKR/1                  2   0.168
*/1-IN.OTH/1-AUTHOR/1                  2   0.168
*/1-IN.OTH/1-OTHACC/1-AUTHOR/1         2   0.168
*/1-OTHACC/1-IN.UKR/1-IN.OTH/1         2   0.168
*/1-OTHACC/1-RENTED/1                  2   0.168
*/1-OTHACC/2-IN.UKR/1                  2   0.168
*/1-OTHACC/2-RENTED/1                  2   0.168
*/1-RENTED/1-AUTHOR/1-IN.UKR/1         2   0.168
*/2-OTHACC/1-AUTHOR/1                  2   0.168
*/2-OTHACC/1-IN.UKR/1                  2   0.168
*/2-OTHACC/1-RENTED/1                  2   0.168
AUTHOR/1-IN.UKR/2                      2   0.168
AUTHOR/1-OTHACC/3                      2   0.168
IN.OTH/1-OTHACC/1-RENTED/2             2   0.168
IN.UKR/1-OTHACC/3                      2   0.168
OTHACC/1-AUTHOR/1-IN.UKR/1-OTHACC/1    2   0.168
OTHACC/1-IN.UKR/1-OTHACC/2             2   0.168
OTHACC/1-RENTED/2                      2   0.168
OTHACC/2-IN.UKR/1                      2   0.168
*/1-AUTHOR/1-IN.UKR/1-OTHACC/1         1   0.084
*/1-AUTHOR/1-OTHACC/1-AUTHOR/1         1   0.084
*/1-AUTHOR/1-RENTED/1                  1   0.084
*/1-AUTHOR/1-RENTED/1-AUTHOR/1         1   0.084
*/1-AUTHOR/2-IN.OTH/1                  1   0.084
*/1-IN.OTH/1-AUTHOR/1-IN.OTH/1         1   0.084
*/1-IN.OTH/1-AUTHOR/1-OTHACC/1         1   0.084
*/1-IN.OTH/1-IN.UKR/1-AUTHOR/1         1   0.084
*/1-IN.OTH/1-IN.UKR/1-OTHACC/1         1   0.084
*/1-IN.OTH/1-OTHACC/1-IN.OTH/1         1   0.084
*/1-IN.UKR/1-AUTHOR/1                  1   0.084
*/1-IN.UKR/1-AUTHOR/1-OTHACC/1         1   0.084
*/1-IN.UKR/1-AUTHOR/2                  1   0.084
*/1-IN.UKR/1-OTHACC/1-AUTHOR/1         1   0.084
*/1-IN.UKR/1-OTHACC/1-IN.UKR/1         1   0.084
*/1-IN.UKR/1-OTHACC/2                  1   0.084
*/1-IN.UKR/2-AUTHOR/1                  1   0.084
*/1-OTHACC/1-AUTHOR/1-RENTED/1         1   0.084
*/1-OTHACC/1-IN.UKR/1-OTHACC/1         1   0.084
*/1-RENTED/1-AUTHOR/1-OTHACC/1         1   0.084
*/1-RENTED/1-IN.UKR/1                  1   0.084
*/1-RENTED/1-IN.UKR/1-AUTHOR/1         1   0.084
*/1-RENTED/2-IN.UKR/1                  1   0.084
*/2-AUTHOR/1-IN.OTH/1                  1   0.084
*/2-AUTHOR/1-RENTED/1                  1   0.084
*/2-IN.OTH/1-OTHACC/1                  1   0.084
*/2-IN.UKR/1-OTHACC/1                  1   0.084
AUTHOR/1-IN.OTH/1-IN.UKR/2             1   0.084
AUTHOR/1-IN.UKR/1-AUTHOR/2             1   0.084
AUTHOR/1-IN.UKR/1-IN.OTH/1             1   0.084
AUTHOR/1-IN.UKR/3                      1   0.084
AUTHOR/1-OTHACC/2                      1   0.084
AUTHOR/1-OTHACC/2-RENTED/1             1   0.084
AUTHOR/1-RENTED/1-AUTHOR/1             1   0.084
AUTHOR/1-RENTED/1-AUTHOR/2             1   0.084
AUTHOR/1-RENTED/2                      1   0.084
AUTHOR/1-RENTED/3                      1   0.084
IN.OTH/1-AUTHOR/1                      1   0.084
IN.OTH/1-AUTHOR/1-IN.UKR/1             1   0.084
IN.OTH/1-AUTHOR/2-RENTED/1             1   0.084
IN.OTH/1-IN.UKR/1-OTHACC/1             1   0.084
IN.OTH/1-IN.UKR/2-AUTHOR/1             1   0.084
IN.OTH/1-OTHACC/1-IN.OTH/2             1   0.084
IN.OTH/1-OTHACC/1-IN.UKR/1-AUTHOR/1    1   0.084
IN.OTH/1-OTHACC/1-IN.UKR/2             1   0.084
IN.OTH/1-OTHACC/2-AUTHOR/1             1   0.084
IN.OTH/1-OTHACC/2-IN.UKR/1             1   0.084
IN.OTH/1-RENTED/2-AUTHOR/1             1   0.084
IN.OTH/2-AUTHOR/1                      1   0.084
IN.OTH/2-AUTHOR/2                      1   0.084
IN.OTH/2-IN.UKR/1-AUTHOR/1             1   0.084
IN.OTH/2-IN.UKR/1-OTHACC/1             1   0.084
IN.OTH/2-OTHACC/1                      1   0.084
IN.OTH/2-OTHACC/1-AUTHOR/1             1   0.084
IN.UKR/1-AUTHOR/1-RENTED/2             1   0.084
IN.UKR/1-AUTHOR/3                      1   0.084
IN.UKR/1-OTHACC/1-AUTHOR/2             1   0.084
IN.UKR/1-OTHACC/1-IN.UKR/1-AUTHOR/1    1   0.084
IN.UKR/1-OTHACC/1-IN.UKR/1-OTHACC/1    1   0.084
IN.UKR/2-AUTHOR/1                      1   0.084
IN.UKR/2-OTHACC/1-AUTHOR/1             1   0.084
OTHACC/1-AUTHOR/1-IN.UKR/2             1   0.084
OTHACC/1-AUTHOR/2-IN.UKR/1             1   0.084
OTHACC/1-AUTHOR/2-RENTED/1             1   0.084
OTHACC/1-IN.OTH/1                      1   0.084
OTHACC/1-RENTED/1                      1   0.084
OTHACC/1-RENTED/1-AUTHOR/1-IN.UKR/1    1   0.084
OTHACC/1-RENTED/1-IN.UKR/2             1   0.084
OTHACC/1-RENTED/3                      1   0.084
OTHACC/2-AUTHOR/1-OTHACC/1             1   0.084
OTHACC/2-AUTHOR/1-RENTED/1             1   0.084
OTHACC/2-IN.UKR/1-AUTHOR/1             1   0.084
OTHACC/3-IN.UKR/1                      1   0.084
OTHACC/3-RENTED/1                      1   0.084
RENTED/1-AUTHOR/1-RENTED/1             1   0.084
RENTED/1-AUTHOR/2                      1   0.084
RENTED/1-OTHACC/1-AUTHOR/2             1   0.084
RENTED/1-OTHACC/3                      1   0.084
RENTED/2-AUTHOR/1                      1   0.084
RENTED/2-IN.UKR/2                      1   0.084
RENTED/3-AUTHOR/1                      1   0.084</code></pre>
</div>
</div>
</section>
<section id="most-frequent-sequences-plot" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="most-frequent-sequences-plot"><span class="header-section-number">4.2</span> Most frequent sequences plot</h2>
<p>The legend that will be used for the sequence charts that follow</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqlegend</span>(sequence.seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Legend for charts</figcaption>
</figure>
</div>
</div>
</div>
<p>Frequency tables contain too much information. A graphical representation allows you to focus on the trajectories that occur most often. The following graph shows 20 sequences that represent 66.2% of all sequences in the data. The frequency of the particular sequence in the chart corresponds to the height of the row.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqfplot</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  sequence.seq, <span class="at">idxs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">with.legend =</span> <span class="cn">FALSE</span>, <span class="at">cex.axis =</span> <span class="fl">0.65</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="cn">TRUE</span>, <span class="at">pbarw =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Twenty most frequent sequences"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To see all the picture we can plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqplot</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seqdata =</span> sequence.seq, <span class="at">type =</span> <span class="st">"I"</span>, <span class="co"># idxs = 1:100,</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">with.legend =</span> <span class="cn">FALSE</span>, <span class="at">cex.axis =</span> <span class="fl">0.65</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sortv =</span> <span class="fu">sortv</span>(sequence.seq, <span class="at">start =</span> <span class="st">"beg"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sortv = tran.seq$acc_R4</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Sorting is possible by final state, which allows you to trace sequences that end in a specific way. Sorting is also possible by any other important feature that describes the household.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqplot</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seqdata =</span> sequence.seq, <span class="at">type =</span> <span class="st">"I"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">with.legend =</span> <span class="cn">FALSE</span>, <span class="at">cex.axis =</span> <span class="fl">0.65</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sortv =</span> <span class="fu">sortv</span>(sequence.seq, <span class="at">start =</span> <span class="st">"end"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transition-types" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="transition-types"><span class="header-section-number">4.3</span> Transition Types</h2>
<p>Even after reducing the number of sequence states, there are too many combinations due to various patterns of missing values to clearly identify the most important trends. To simplify the analysis, it makes sense to combine the sequences into groups (types). One approach proposed in the literature is to use cluster analysis. However, the hierarchical cluster analysis did not allow me to obtain logical clear groups, so I decided to go the other way: to classify the sequences based on the type of transitions from one state to another. To this end, the number of transitions in our data is first determined:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>transitions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">seqtransn</span>(sequence.seq))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>(tb <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(transitions)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>transitions
         0          1          2          3 
66.9740151 25.9849120  6.5381391  0.5029338 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  tb, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">4</span>),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Number of transitions"</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, the bulk of the sequences are those without transitions, which can be called stable trajectories.</p>
<p>Now you can distinguish groups of sequences based on the number of transitions: no transitions, one transition, two transitions, more than one transition, and so on:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sequence.seq <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transitions <span class="sc">==</span> <span class="dv">0</span>) <span class="ot">-&gt;</span> tran0.seq</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>sequence.seq <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transitions <span class="sc">==</span> <span class="dv">1</span>) <span class="ot">-&gt;</span> tran1.seq</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>sequence.seq <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transitions <span class="sc">==</span> <span class="dv">2</span>) <span class="ot">-&gt;</span> tran2.seq</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>sequence.seq <span class="sc">%&gt;%</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transitions <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="ot">-&gt;</span> tran.seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stable-sequences" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="stable-sequences"><span class="header-section-number">4.4</span> Stable sequences</h2>
<p>Twenty most frequent sequences cover 93.8% of time-stable sequences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tran0.seq <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seqfplot</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">idxs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">with.legend =</span> F,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.65</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pbarw =</span> T,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"20 stable sequences of accommodation"</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can simplify the presentation of information about time-stable sequences by ignoring their differences in the location of missing values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Stable frequencies</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> tran0.seq</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>u[u <span class="sc">==</span> <span class="st">"*"</span> <span class="sc">|</span> u <span class="sc">==</span> <span class="st">"%"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> u, <span class="at">MARGIN =</span> <span class="dv">1</span>, first, <span class="at">na_rm =</span> <span class="cn">TRUE</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> sjmisc<span class="sc">::</span><span class="fu">frq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x &lt;character&gt; 
# total N=799 valid N=799 mean=1.54 sd=0.75

Value  |   N | Raw % | Valid % | Cum. %
---------------------------------------
AUTHOR | 492 | 61.58 |   61.58 |  61.58
OTHACC | 183 | 22.90 |   22.90 |  84.48
RENTED | 124 | 15.52 |   15.52 | 100.00
&lt;NA&gt;   |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</code></pre>
</div>
</div>
<p>Now you can group time-stable sequences by accommodation type in one chart:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Grouped</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> u, <span class="at">MARGIN =</span> <span class="dv">1</span>, first, <span class="at">na_rm =</span> <span class="cn">TRUE</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>tran0.seq <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seqfplot</span>(</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">idxs =</span> <span class="dv">0</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">with.legend =</span> <span class="cn">TRUE</span>, <span class="at">cex.axis =</span> <span class="fl">0.65</span>, <span class="at">pbarw =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Stable accommodation"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> grp</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sequences-with-transitions" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sequences-with-transitions"><span class="header-section-number">4.5</span> Sequences with transitions</h2>
<p>Now you can look at sequences with any number of transitions separately. For example, this table contains sequences with one or more state transitions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtab</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  tran.seq, <span class="at">idxs =</span> <span class="dv">0</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    Freq Percent
*/1-RENTED/1-AUTHOR/2                 43   10.91
*/1-OTHACC/1-IN.UKR/2                 16    4.06
OTHACC/1-AUTHOR/3                     16    4.06
*/1-AUTHOR/1-IN.UKR/2                 13    3.30
*/1-OTHACC/1-AUTHOR/2                 13    3.30
*/1-RENTED/1-AUTHOR/1                 10    2.54
*/1-OTHACC/1-AUTHOR/1                  9    2.28
OTHACC/1-AUTHOR/2                      9    2.28
*/1-OTHACC/2-AUTHOR/1                  8    2.03
OTHACC/1-IN.UKR/3                      8    2.03
OTHACC/2-AUTHOR/2                      7    1.78
RENTED/2-AUTHOR/2                      7    1.78
*/1-AUTHOR/1-IN.UKR/1                  6    1.52
*/1-RENTED/1-IN.UKR/2                  6    1.52
*/1-OTHACC/1-RENTED/2                  5    1.27
*/1-RENTED/1-AUTHOR/1-RENTED/1         5    1.27
IN.OTH/1-OTHACC/1-AUTHOR/2             5    1.27
OTHACC/1-RENTED/1-AUTHOR/1             5    1.27
OTHACC/1-RENTED/1-AUTHOR/2             5    1.27
RENTED/1-AUTHOR/3                      5    1.27
*/1-AUTHOR/2-RENTED/1                  4    1.02
*/1-IN.OTH/1-AUTHOR/2                  4    1.02
*/1-RENTED/2-AUTHOR/1                  4    1.02
*/2-RENTED/1-AUTHOR/1                  4    1.02
IN.OTH/1-AUTHOR/3                      4    1.02
IN.OTH/2-OTHACC/2                      4    1.02
IN.OTH/3-AUTHOR/1                      4    1.02
OTHACC/1-IN.UKR/2                      4    1.02
OTHACC/2-IN.UKR/2                      4    1.02
RENTED/1-IN.UKR/3                      4    1.02
*/1-IN.OTH/1-OTHACC/2                  3    0.76
*/1-IN.OTH/2-AUTHOR/1                  3    0.76
*/1-IN.OTH/2-OTHACC/1                  3    0.76
AUTHOR/1-OTHACC/1-AUTHOR/2             3    0.76
AUTHOR/2-IN.UKR/2                      3    0.76
IN.OTH/1-OTHACC/3                      3    0.76
OTHACC/1-AUTHOR/1                      3    0.76
OTHACC/1-IN.OTH/3                      3    0.76
OTHACC/2-AUTHOR/1                      3    0.76
RENTED/1-IN.UKR/1                      3    0.76
*/1-AUTHOR/1-OTHACC/2                  2    0.51
*/1-AUTHOR/1-RENTED/2                  2    0.51
*/1-AUTHOR/2-IN.UKR/1                  2    0.51
*/1-IN.OTH/1-AUTHOR/1                  2    0.51
*/1-IN.OTH/1-OTHACC/1-AUTHOR/1         2    0.51
*/1-OTHACC/1-IN.UKR/1-IN.OTH/1         2    0.51
*/1-OTHACC/1-RENTED/1                  2    0.51
*/1-OTHACC/2-IN.UKR/1                  2    0.51
*/1-OTHACC/2-RENTED/1                  2    0.51
*/1-RENTED/1-AUTHOR/1-IN.UKR/1         2    0.51
*/2-OTHACC/1-AUTHOR/1                  2    0.51
*/2-OTHACC/1-IN.UKR/1                  2    0.51
*/2-OTHACC/1-RENTED/1                  2    0.51
AUTHOR/1-IN.UKR/2                      2    0.51
AUTHOR/1-OTHACC/3                      2    0.51
IN.OTH/1-OTHACC/1-RENTED/2             2    0.51
IN.UKR/1-OTHACC/3                      2    0.51
OTHACC/1-AUTHOR/1-IN.UKR/1-OTHACC/1    2    0.51
OTHACC/1-IN.UKR/1-OTHACC/2             2    0.51
OTHACC/1-RENTED/2                      2    0.51
OTHACC/2-IN.UKR/1                      2    0.51
*/1-AUTHOR/1-IN.UKR/1-OTHACC/1         1    0.25
*/1-AUTHOR/1-OTHACC/1-AUTHOR/1         1    0.25
*/1-AUTHOR/1-RENTED/1                  1    0.25
*/1-AUTHOR/1-RENTED/1-AUTHOR/1         1    0.25
*/1-AUTHOR/2-IN.OTH/1                  1    0.25
*/1-IN.OTH/1-AUTHOR/1-IN.OTH/1         1    0.25
*/1-IN.OTH/1-AUTHOR/1-OTHACC/1         1    0.25
*/1-IN.OTH/1-IN.UKR/1-AUTHOR/1         1    0.25
*/1-IN.OTH/1-IN.UKR/1-OTHACC/1         1    0.25
*/1-IN.OTH/1-OTHACC/1-IN.OTH/1         1    0.25
*/1-IN.UKR/1-AUTHOR/1                  1    0.25
*/1-IN.UKR/1-AUTHOR/1-OTHACC/1         1    0.25
*/1-IN.UKR/1-AUTHOR/2                  1    0.25
*/1-IN.UKR/1-OTHACC/1-AUTHOR/1         1    0.25
*/1-IN.UKR/1-OTHACC/1-IN.UKR/1         1    0.25
*/1-IN.UKR/1-OTHACC/2                  1    0.25
*/1-IN.UKR/2-AUTHOR/1                  1    0.25
*/1-OTHACC/1-AUTHOR/1-RENTED/1         1    0.25
*/1-OTHACC/1-IN.UKR/1-OTHACC/1         1    0.25
*/1-RENTED/1-AUTHOR/1-OTHACC/1         1    0.25
*/1-RENTED/1-IN.UKR/1                  1    0.25
*/1-RENTED/1-IN.UKR/1-AUTHOR/1         1    0.25
*/1-RENTED/2-IN.UKR/1                  1    0.25
*/2-AUTHOR/1-IN.OTH/1                  1    0.25
*/2-AUTHOR/1-RENTED/1                  1    0.25
*/2-IN.OTH/1-OTHACC/1                  1    0.25
*/2-IN.UKR/1-OTHACC/1                  1    0.25
AUTHOR/1-IN.OTH/1-IN.UKR/2             1    0.25
AUTHOR/1-IN.UKR/1-AUTHOR/2             1    0.25
AUTHOR/1-IN.UKR/1-IN.OTH/1             1    0.25
AUTHOR/1-IN.UKR/3                      1    0.25
AUTHOR/1-OTHACC/2                      1    0.25
AUTHOR/1-OTHACC/2-RENTED/1             1    0.25
AUTHOR/1-RENTED/1-AUTHOR/1             1    0.25
AUTHOR/1-RENTED/1-AUTHOR/2             1    0.25
AUTHOR/1-RENTED/2                      1    0.25
AUTHOR/1-RENTED/3                      1    0.25
IN.OTH/1-AUTHOR/1                      1    0.25
IN.OTH/1-AUTHOR/1-IN.UKR/1             1    0.25
IN.OTH/1-AUTHOR/2-RENTED/1             1    0.25
IN.OTH/1-IN.UKR/1-OTHACC/1             1    0.25
IN.OTH/1-IN.UKR/2-AUTHOR/1             1    0.25
IN.OTH/1-OTHACC/1-IN.OTH/2             1    0.25
IN.OTH/1-OTHACC/1-IN.UKR/1-AUTHOR/1    1    0.25
IN.OTH/1-OTHACC/1-IN.UKR/2             1    0.25
IN.OTH/1-OTHACC/2-AUTHOR/1             1    0.25
IN.OTH/1-OTHACC/2-IN.UKR/1             1    0.25
IN.OTH/1-RENTED/2-AUTHOR/1             1    0.25
IN.OTH/2-AUTHOR/1                      1    0.25
IN.OTH/2-AUTHOR/2                      1    0.25
IN.OTH/2-IN.UKR/1-AUTHOR/1             1    0.25
IN.OTH/2-IN.UKR/1-OTHACC/1             1    0.25
IN.OTH/2-OTHACC/1                      1    0.25
IN.OTH/2-OTHACC/1-AUTHOR/1             1    0.25
IN.UKR/1-AUTHOR/1-RENTED/2             1    0.25
IN.UKR/1-AUTHOR/3                      1    0.25
IN.UKR/1-OTHACC/1-AUTHOR/2             1    0.25
IN.UKR/1-OTHACC/1-IN.UKR/1-AUTHOR/1    1    0.25
IN.UKR/1-OTHACC/1-IN.UKR/1-OTHACC/1    1    0.25
IN.UKR/2-AUTHOR/1                      1    0.25
IN.UKR/2-OTHACC/1-AUTHOR/1             1    0.25
OTHACC/1-AUTHOR/1-IN.UKR/2             1    0.25
OTHACC/1-AUTHOR/2-IN.UKR/1             1    0.25
OTHACC/1-AUTHOR/2-RENTED/1             1    0.25
OTHACC/1-IN.OTH/1                      1    0.25
OTHACC/1-RENTED/1                      1    0.25
OTHACC/1-RENTED/1-AUTHOR/1-IN.UKR/1    1    0.25
OTHACC/1-RENTED/1-IN.UKR/2             1    0.25
OTHACC/1-RENTED/3                      1    0.25
OTHACC/2-AUTHOR/1-OTHACC/1             1    0.25
OTHACC/2-AUTHOR/1-RENTED/1             1    0.25
OTHACC/2-IN.UKR/1-AUTHOR/1             1    0.25
OTHACC/3-IN.UKR/1                      1    0.25
OTHACC/3-RENTED/1                      1    0.25
RENTED/1-AUTHOR/1-RENTED/1             1    0.25
RENTED/1-AUTHOR/2                      1    0.25
RENTED/1-OTHACC/1-AUTHOR/2             1    0.25
RENTED/1-OTHACC/3                      1    0.25
RENTED/2-AUTHOR/1                      1    0.25
RENTED/2-IN.UKR/2                      1    0.25
RENTED/3-AUTHOR/1                      1    0.25</code></pre>
</div>
</div>
<p>The most informative way to represent such sequences is in the form of a table of transitions between individual states. Such tables can also be built for transitions between individual rounds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table of transitions</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtrate</span>(tran1.seq, <span class="at">with.missing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>  <span class="co"># , time.varying = TRUE</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] computing transition probabilities for states AUTHOR/RENTED/OTHACC/IN.UKR/IN.OTH/* ...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            [-&gt; AUTHOR] [-&gt; RENTED] [-&gt; OTHACC] [-&gt; IN.UKR] [-&gt; IN.OTH] [-&gt; *]
[AUTHOR -&gt;]        0.63        0.04        0.02        0.12        0.01   0.18
[RENTED -&gt;]        0.58        0.23        0.01        0.12        0.00   0.05
[OTHACC -&gt;]        0.37        0.08        0.31        0.21        0.02   0.01
[IN.UKR -&gt;]        0.05        0.00        0.04        0.74        0.00   0.17
[IN.OTH -&gt;]        0.32        0.00        0.24        0.00        0.43   0.02
[* -&gt;]             0.16        0.33        0.30        0.02        0.08   0.11</code></pre>
</div>
</div>
<p>You can visualize transition tables using heatmaps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqtrate</span>(tran.seq, <span class="at">with.missing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"square"</span>, <span class="at">is.corr =</span> <span class="cn">FALSE</span>, <span class="at">addCoef.col =</span> <span class="st">"blue"</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> [&gt;] computing transition probabilities for states AUTHOR/RENTED/OTHACC/IN.UKR/IN.OTH/* ...</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A chronograph chart shows the dynamics of state distributions between rounds for sequences with transitions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqdplot</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  tran.seq, <span class="at">main =</span> <span class="st">"State distribution plot (transitions)"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">with.legend =</span> F, <span class="at">cex.axis =</span> <span class="fl">0.65</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="accommodation_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./trajectories.html" class="pagination-link" aria-label="Trajectory mining">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trajectory mining</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>